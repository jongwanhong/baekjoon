프로그래머스 mysql 언어

## where

```sql
SELECT ANIMAL_ID, NAME, SEX_UPON_INTAKE FROM ANIMAL_INS WHERE NAME = 'Lucy' or NAME = 'Ella' or NAME = 'Pickle' or NAME =  'Rogan' or NAME = 'Sabrina' or NAME = 'Mitty'
```

### like

```sql
SELECT ANIMAL_ID, NAME FROM ANIMAL_INS WHERE (NAME LIKE '%el%') AND (ANIMAL_TYPE = 'Dog')  ORDER BY NAME
```

## CASE

```sql
SELECT ANIMAL_ID, NAME, CASE WHEN(SEX_UPON_INTAKE like '%Neutered%' or SEX_UPON_INTAKE like '%Spayed%') THEN 'O' ELSE 'X' END AS '중성화'
FROM ANIMAL_INS ORDER BY ANIMAL_ID
```

## ORDER BY

[주의] 여러 조건으로 조회할 때는 정렬 방식을 명시해주어야 한다(ASC, DESC)

```sql
SELECT ANIMAL_ID, NAME, DATETIME FROM ANIMAL_INS ORDER BY NAME ASC, DATETIME DESC
```

## 최대, 최소

```sql
SELECT DATETIME FROM ANIMAL_INS ORDER BY DATETIME DESC limit 1
SELECT max(DATETIME) FROM ANIMAL_INS
```

```sql
# 가장 먼저 들어온 동물
SELECT DATETIME as '시간' FROM ANIMAL_INS ORDER BY DATETIME limit 1
SELECT NAME FROM ANIMAL_INS ORDER BY DATETIME limit 1
```

## ISNULL

```sql
SELECT ANIMAL_ID FROM ANIMAL_INS WHERE NAME IS NULL
```

```sql
SELECT ANIMAL_ID FROM ANIMAL_INS WHERE NAME IS NOT NULL
```

null 일 경우 대체하여 출력

```sql
SELECT ANIMAL_TYPE, IFNULL(NAME, "No name") AS NAME, SEX_UPON_INTAKE FROM ANIMAL_INS ORDER BY ANIMAL_ID
```

## GROUP BY

### 전체 데이터 개수

```sql
SELECT COUNT(ANIMAL_ID) AS count FROM ANIMAL_INS
```

```sql
SELECT NAME, COUNT(NAME) as COUNT FROM ANIMAL_INS GROUP BY NAME HAVING COUNT >= 2 ORDER BY NAME
```

## DATETIME

### HOUR

```sql
SELECT HOUR(DATETIME) AS HOUR, COUNT(DATETIME) AS COUNT FROM ANIMAL_OUTS
WHERE HOUR(DATETIME) >=9 and  HOUR(DATETIME) < 20 GROUP BY HOUR(DATETIME) ORDER BY HOUR(DATETIME)
```

### date_format

```sql
SELECT ANIMAL_ID, NAME, DATE_FORMAT(DATETIME, '%Y-%m-%d') AS '날짜' FROM ANIMAL_INS
```

## join

[https://programmers.co.kr/learn/courses/30/lessons/59042](https://programmers.co.kr/learn/courses/30/lessons/59042)

```sql
SELECT A.ANIMAL_ID, A.NAME
FROM ANIMAL_OUTS A LEFT JOIN ANIMAL_INS B ON A.ANIMAL_ID = B.ANIMAL_ID
WHERE B.ANIMAL_ID IS NULL
ORDER BY A.ANIMAL_ID
```

```sql
SELECT A.ANIMAL_ID, A.NAME FROM ANIMAL_INS A JOIN ANIMAL_OUTS B ON A.ANIMAL_ID = B.ANIMAL_ID
WHERE A.DATETIME >= B.DATETIME ORDER BY A.DATETIME
```

```sql
# 아직 입양을 못 간 동물 중, 가장 오래 보호소에 있었던 동물 3마리의 이름과 보호 시작일을 조회하는 SQL문을 작성해주세요.
SELECT I.NAME, I.DATETIME FROM ANIMAL_INS I LEFT JOIN ANIMAL_OUTS O USING(ANIMAL_ID) WHERE O.ANIMAL_ID IS NULL
ORDER BY I.DATETIME limit 3
```

### JOIN + DATETIME 연산

```sql
SELECT O.ANIMAL_ID, O.NAME
FROM ANIMAL_OUTS O LEFT JOIN ANIMAL_INS I USING(ANIMAL_ID)
ORDER BY (O.DATETIME - I.DATETIME) DESC
LIMIT 2
```

## 서브쿼리

```sql
SELECT COUNT(*) AS count FROM (SELECT NAME
    FROM ANIMAL_INS
    WHERE NAME IS NOT NULL
    GROUP BY NAME) SUB
```

### 헤비 유저가 소유한 장소

```sql
SELECT ID, NAME, HOST_ID
FROM PLACES
WHERE HOST_ID IN (
    SELECT HOST_ID
    FROM PLACES
    GROUP BY HOST_ID
    HAVING COUNT(ID) >= 2)
ORDER BY ID
```

## Level 4

### 우유와 요거트가 담긴 장바구니

요거트가 담긴 목록, 우유가 담긴 목록을 뽑고, CART ID가 같은것을 출력

```sql
 SELECT A.CART_ID FROM
 (SELECT CART_ID FROM CART_PRODUCTS WHERE NAME = 'Yogurt') as A,
 (SELECT CART_ID FROM CART_PRODUCTS WHERE NAME = 'Milk') as B
 WHERE A.CART_ID = B.CART_ID ORDER BY CART_ID
```

### 보호소에서 중성화한 동물

보호소에서 들어올 당시엔 중성화 안되어있고, 나갈 당시 중성화 된 동물 찾기.

```sql
SELECT O.ANIMAL_ID, O.ANIMAL_TYPE, O.NAME FROM ANIMAL_OUTS O JOIN ANIMAL_INS I ON O.ANIMAL_ID = I.ANIMAL_ID
WHERE I.SEX_UPON_INTAKE LIKE 'Intact%' AND (O.SEX_UPON_OUTCOME LIKE 'Spayed%' OR O.SEX_UPON_OUTCOME LIKE 'Neutered%')
```
